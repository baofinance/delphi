name: Dapptools Tests

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  test:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Install Dapptools
      uses: risedle/setup-dapptools@v4

    - name: Fetch Submodule Dependencies
      run: dapp update

    - name: Set Remappings ENV
      run: export DAPP_REMAPPINGS=$(cat ../../remappings.txt)

    - name: Run Tests
      run: dapp test --rpc-url https://eth-mainnet.alchemyapi.io/v2/0Zix9biOoC7oFAdYd8I2LDkYOrO70c0k --rpc-block 14305846
